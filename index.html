<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Advance Digital Coding Test</title>

    <script src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  </head>

  <body>
    <div id="root"></div>

    <script></script>
    <script type="text/babel">
      const urlStarWars = 'https://swapi.co/api/people/';
      const urlPokemon = 'https://pokeapi.co/api/v2/pokemon/';

      const Pokemon = ({ pokemon }) => {
        if (pokemon) {
          console.log(pokemon);
        }
        return (
          <>
            <div id={pokemon.name}>name: {pokemon.name}</div>
            <div id={pokemon.height}>height: {pokemon.height}</div>
            <div className='abilities' id={pokemon.abilities}>
              abilitites:
              {console.log(pokemon.abilities)}
              {pokemon.abilities ? (
                pokemon.abilities.map(item => {
                  return (
                    <div key={item.ability.name} className='ability'>
                      {item.ability.name}
                    </div>
                  );
                })
              ) : (
                <></>
              )}
            </div>
            <div id={pokemon.id}>id: {pokemon.id}</div>
            <div id={pokemon.weight}>weight: {pokemon.weight}</div>
            <div id={pokemon.sprites}>
              {pokemon.sprites ? (
                Object.keys(pokemon.sprites).map(key => {
                  if (pokemon.sprites[key] && key.indexOf('female') < 0) {
                    return <img src={pokemon.sprites[key]} />;
                  }
                })
              ) : (
                <></>
              )}
            </div>
          </>
        );
      };

      const StarWars = ({ charactor, homeworld }) => {
        // if (charactor) {
        //   console.log(charactor);
        // }
        // if (homeworld) {
        //   console.log(homeworld);
        // }
        return (
          <div>
            <div id={charactor.name}>{charactor.name}</div>
            <div id={charactor.eye_color}>{charactor.eye_color}</div>
            <div id={charactor.gender}>
              {charactor.gender}
              <div className={`${charactor.gender} gender`} />
            </div>
            <div id={charactor.hair_color}>{charactor.hair_color}</div>
            <div id={charactor.mass}>{charactor.mass}</div>
            <div id={charactor.skin_color}>{charactor.skin_color}</div>
            <div id={charactor.height}>{charactor.height}</div>
            <div id={homeworld.name}>{homeworld.name}</div>
          </div>
        );
      };

      class App extends React.Component {
        constructor(props) {
          super(props);
          this.state = {
            pokemon: {},
            starWars: {},
            homeworld: {},
          };
        }

        componentDidMount() {
          this.getPokemon();
          this.getCharactor();
        }

        getPokemon() {
          let pokemon = Math.floor(Math.random(0, 1) * 300);

          axios
            .get(`${urlPokemon}${pokemon}`)
            .then(response => {
              this.setState({ pokemon: response.data });
            })
            .catch(err => {
              console.error(err);
            });
        }

        getCharactor() {
          let charactor = Math.floor(Math.random(0, 1) * 50 + 1);
          if (charactor === 17) {
            charactor++;
          }
          axios
            .get(`${urlStarWars}${charactor}/`)
            .then(response => {
              this.setState({ starWars: response.data });
              // return axios.get(response.data.homeworld)
              // }).then(response => {
              //   this.setState({
              //     homeworld: response.data
              //   })
            })
            .catch(err => {
              console.error(err);
            });
        }

        render() {
          return (
            <>
              <h1>Star Wars Charactor and their Pokemon!</h1>

              <div id='flex-container'>
                <div id='charactor'>
                  <button
                    onClick={e => {
                      this.getCharactor();
                    }}>
                    Select a charactor
                  </button>
                  <StarWars
                    charactor={this.state.starWars}
                    homeworld={this.state.homeworld}
                  />
                </div>

                <div id='pokemon'>
                  <button
                    onClick={e => {
                      this.getPokemon();
                    }}>
                    Assign a Pokemon
                  </button>
                  <Pokemon pokemon={this.state.pokemon} />
                </div>
              </div>
            </>
          );
        }
      }
      ReactDOM.render(<App />, document.getElementById('root'));
    </script>

    <style>
      #flex-container {
        display: flex;
        flex-direction: row;
        width: 80%;
      }

      .gender {
        width: 100px;
        height: 100px;
        border-radius: 100%;
        background-image: url(https://gravatar.com/avatar/b1c60bfdfa49a425b2a67140f9673064?s=100&d=robohash&r=x);
      }

      .male {
        background-image: url(https://robohash.org/0eeed36917e788e93ea4e92bc35332e4?set=set4&bgset=&size=100x100);
      }

      .female {
        background-image: url(https://robohash.org/8b21a540f50d4bebef91f445a58163c6?set=set4&bgset=&size=100x100);
      }
    </style>
  </body>
</html>
